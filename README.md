# Antenna

Antennaæ˜¯58åŒåŸå®‰å…¨å›¢é˜Ÿæ‰“é€ çš„ä¸€æ¬¾è¾…åŠ©å®‰å…¨ä»ä¸šäººå‘˜è¾…åŠ©éªŒè¯ç½‘ç»œä¸­å¤šç§æ¼æ´æ˜¯å¦å­˜åœ¨ä»¥åŠå¯åˆ©ç”¨æ€§çš„å·¥å…·ã€‚å…¶åŸºäºå¸¦å¤–åº”ç”¨å®‰å…¨æµ‹è¯•(OAST)ï¼Œå°†ä¸åŒæ¼æ´åœºæ™¯æ£€æµ‹èƒ½åŠ›é€šè¿‡æ’ä»¶çš„å½¢å¼è¿›è¡Œé›†åˆï¼Œé€šè¿‡ä¸ç›®æ ‡è¿›è¡Œout-bindçš„æ•°æ®é€šä¿¡æ–¹å¼è¿›è¡Œè¾…åŠ©æ£€æµ‹ã€‚


## å…è´£å£°æ˜

1. æœ¬å·¥å…·ä»…é¢å‘ åˆæ³•æˆæƒ çš„ä¼ä¸šå®‰å…¨å»ºè®¾è¡Œä¸ºä¸ä¸ªäººå­¦ä¹ è¡Œä¸ºï¼Œå¦‚æ‚¨éœ€è¦æµ‹è¯•æœ¬å·¥å…·çš„å¯ç”¨æ€§ï¼Œè¯·è‡ªè¡Œæ­å»ºé¶æœºç¯å¢ƒã€‚
2. å¦‚æ‚¨åœ¨ä½¿ç”¨æœ¬å·¥å…·çš„è¿‡ç¨‹ä¸­å­˜åœ¨ä»»ä½•éæ³•è¡Œä¸ºï¼Œæ‚¨éœ€è‡ªè¡Œæ‰¿æ‹…ç›¸åº”åæœï¼Œæˆ‘ä»¬å°†ä¸æ‰¿æ‹…ä»»ä½•æ³•å¾‹åŠè¿å¸¦è´£ä»»ã€‚
   åœ¨å®‰è£…å¹¶ä½¿ç”¨æœ¬å·¥å…·å‰ï¼Œè¯·æ‚¨ åŠ¡å¿…å®¡æ…é˜…è¯»ã€å……åˆ†ç†è§£å„æ¡æ¬¾å†…å®¹é™åˆ¶ã€å…è´£æ¡æ¬¾æˆ–è€…å…¶ä»–æ¶‰åŠæ‚¨é‡å¤§æƒç›Šçš„æ¡æ¬¾å¯èƒ½ä¼šä»¥
   åŠ ç²—ã€åŠ ä¸‹åˆ’çº¿ç­‰å½¢å¼æç¤ºæ‚¨é‡ç‚¹æ³¨æ„ã€‚
   é™¤éæ‚¨å·²å……åˆ†é˜…è¯»ã€å®Œå…¨ç†è§£å¹¶æ¥å—æœ¬åè®®æ‰€æœ‰æ¡æ¬¾ï¼Œå¦åˆ™ï¼Œè¯·æ‚¨ä¸è¦å®‰è£…å¹¶ä½¿ç”¨æœ¬å·¥å…·ã€‚æ‚¨çš„ä½¿ç”¨è¡Œä¸ºæˆ–è€…æ‚¨ä»¥å…¶ä»–ä»»ä½•æ˜ç¤ºæˆ–è€…é»˜ç¤ºæ–¹å¼è¡¨ç¤ºæ¥å—æœ¬åè®®çš„ï¼Œå³è§†ä¸ºæ‚¨å·²é˜…è¯»å¹¶åŒæ„æœ¬åè®®çš„çº¦æŸã€‚

## Antennaç®€ä»‹

Antennaæ˜¯58åŒåŸå®‰å…¨å›¢é˜Ÿæ‰“é€ çš„ä¸€æ¬¾è¾…åŠ©å®‰å…¨ä»ä¸šäººå‘˜è¾…åŠ©éªŒè¯ç½‘ç»œä¸­å¤šç§æ¼æ´æ˜¯å¦å­˜åœ¨ä»¥åŠå¯åˆ©ç”¨æ€§çš„å·¥å…·ã€‚å…¶åŸºäºå¸¦å¤–åº”ç”¨å®‰å…¨æµ‹è¯•(
OAST)é€šè¿‡ä»»åŠ¡çš„å½¢å¼ï¼Œå°†ä¸åŒæ¼æ´åœºæ™¯æ£€æµ‹èƒ½åŠ›é€šè¿‡æ’ä»¶çš„å½¢å¼è¿›è¡Œé›†åˆï¼Œé€šè¿‡ä¸ç›®æ ‡è¿›è¡Œout-bindçš„æ•°æ®é€šä¿¡æ–¹å¼è¿›è¡Œè¾…åŠ©æ£€æµ‹ã€‚

## Antennaçš„ç›®æ ‡

æˆ‘ä»¬ç»ä¸ä»…ä»…åªæ˜¯å°†Antennaåšæˆä¸€æ¬¾åªèƒ½ç›‘å¬DNSã€HTTPç­‰åè®®æ¥ç®€å•åˆ¤æ–­æ— å›æ˜¾ç±»å‹æ¼æ´çš„å·¥å…·ï¼Œæˆ‘ä»¬çš„ç›®æ ‡æ˜¯å°è¯•åœ¨è‰¯å¥½ä½¿ç”¨ä½“éªŒçš„åŸºç¡€ä¸Šæ”¯æŒé«˜åº¦çµæ´»çš„è‡ªå®šä¹‰ç»„ä»¶èƒ½åŠ›ï¼Œæ»¡è¶³ç”¨æˆ·é€šè¿‡Antennaæ¢ç´¢å¹¶å®ç°å„ç§åº”ç”¨å®‰å…¨æ¼æ´åœºæ™¯çš„è¾…åŠ©æ£€æµ‹ã€‚å°½å¯èƒ½å¾—å®ç°é€šè¿‡Antennaè¿™æ¬¾äº§å“é™ä½å„ç§å®‰å…¨æ¼æ´åœºæ™¯çš„æ£€æµ‹æˆæœ¬ã€‚

## 1. éƒ¨ç½²æ•™ç¨‹

éƒ¨ç½²å‰æ‰€éœ€

ä¸€å°å…¬ç½‘æœåŠ¡å™¨

ä¸€ä¸ªåŸŸå

åŸŸåè§£æåŠDNSé…ç½® ,å¯å‚è€ƒä¸‹æ–‡ [2.1.2.1 åŸŸåé…ç½®åŠé˜¿é‡Œäº‘dnsæœåŠ¡ä¿®æ”¹æ•™ç¨‹](#2.1.2.1 åŸŸåé…ç½®åŠé˜¿é‡Œäº‘dnsæœåŠ¡ä¿®æ”¹æ•™ç¨‹)

### 1.1 æºç éƒ¨ç½²

æºç éƒ¨ç½²æœåŠ¡å™¨ç³»ç»Ÿæ¨èä½¿ç”¨centosï¼Œå¦‚éœ€éƒ¨ç½²å…¶ä»–æœåŠ¡å™¨ç³»ç»Ÿéœ€ä¿®æ”¹é¡¹ç›®ä¸­install.sh ä¸­éƒ¨åˆ†å®‰è£…å‘½ä»¤

ä¸‹è½½æºç 

```
git clone https://github.com/WUBA/Antenna.git
```

è¿›å…¥é¡¹ç›®è¿è¡Œinstall è„šæœ¬

```
cd ./Antenna/bin 
chmod +x ./*
./install.sh
```

è„šæœ¬è¿è¡ŒæŒ‰ç…§æç¤ºå¡«å†™è¿æ¥æ•°æ®åº“é…ç½®ä¸åŸŸåä¿¡æ¯,å¦‚æ­¤æ—¶åŸŸåè¿˜æœªé…ç½®è§£æï¼Œplatform_domainä¹Ÿå¡«å†™ä¸ºæœåŠ¡å™¨çš„å…¬ç½‘ipï¼Œå¦åˆ™ä¼šå½±å“ç³»ç»Ÿæ¥å£çš„è®¿é—®
![img.png](imgs/img_plat.png)
å¡«å†™ç¤ºä¾‹

```angular2html
mysql ip: 127.0.0.1
mysql port: 3306
mysql username: root
mysql password: 123456
platform_domain: test.com
platform_ip:1.1.1.1
```

ç³»ç»Ÿä¼šè‡ªåŠ¨åˆ›å»ºåˆå§‹ç®¡ç†å‘˜è´¦æˆ·antenna@58.com å¯†ç ï¼šantenna@58.com
è®¿é—®ä¹‹å‰è¾“å…¥åŸŸåç³»ç»Ÿçš„8000ç«¯å£ï¼Œå¯è®¿é—®ç³»ç»Ÿåå°å¹¶è®¿é—®
![img.png](imgs/img_start.png)

### 1.2 Dockeréƒ¨ç½²

## 2. ä½¿ç”¨æ•™ç¨‹

### 2.1 Antennaåˆå§‹é…ç½®æ•™ç¨‹

#### 2.1.1 å¹³å°è®¾ç½®

ç®¡ç†å‘˜è´¦æˆ·å¯è¿›å…¥ç³»ç»Ÿè®¾ç½®-å¹³å°ç®¡ç†é¡µé¢å¯¹å¹³å°è¿›è¡Œé…ç½®
å¹³å°é…ç½®è¯´æ˜

| é…ç½®åç§°     | è¯´æ˜                               |
|----------|----------------------------------|
| å¼€æ”¾æ³¨å†Œ     | å¼€å¯åå¹³å°å…è®¸ç”¨æˆ·æ³¨å†Œä½¿ç”¨ï¼Œè¯¥åŠŸèƒ½éœ€å®Œæˆé‚®ç®±ç›¸å…³é…ç½®       |
| ä»…å…è®¸é‚€è¯·æ³¨å†Œ  | å¼€å¯åå¹³å°åªå…è®¸æ‹¥æœ‰é‚€è¯·ç ç”¨æˆ·æ³¨å†Œä½¿ç”¨ï¼Œè¯¥åŠŸèƒ½éœ€å®Œæˆé‚®ç®±ç›¸å…³é…ç½® |
| å¼€å¯é‚®ä»¶é€šçŸ¥   | å¼€å¯åå¹³å°æ¥æ”¶åˆ°æ¶ˆæ¯åéƒ½ä¼šé‚®ä»¶é€šçŸ¥ç”¨æˆ·ï¼Œè¯¥åŠŸèƒ½éœ€å®Œæˆé‚®ç®±ç›¸å…³é…ç½® |
| SMTP æœåŠ¡å™¨ | é‚®ç®±æœåŠ¡å™¨                            |
| ç«¯å£       | é‚®ç®±æœåŠ¡å™¨ç«¯å£ï¼ŒQQé‚®ç®±ä¸º465                 |
| è´¦å·       | å‘é€é‚®ä»¶çš„é‚®ç®±è´¦å·                        |
| å¯†ç /æˆæƒç    | é‚®ä»¶è´¦å·æˆæƒç                           |

##### 2.1.1.1 é‚®ç®±æˆæƒç è®¾ç½®åŠQQé‚®ç®±æˆæƒç ç”³è¯·æ•™ç¨‹

`https://service.mail.qq.com/cgi-bin/help?subtype=1&id=28&no=1001256`

#### 2.1.2 åè®®è®¾ç½®

åè®®é…ç½®è¯´æ˜

| é…ç½®åç§°      | è¯´æ˜                           |
|-----------|------------------------------|
| DNSè®°å½•åŸŸå   | DNSè¯·æ±‚åŸŸå                      |
| è§£æip      | ä½¿ç”¨ç³»ç»ŸæœåŠ¡å™¨å…¬ç½‘ip                  |
| NS1\NS2åŸŸå | DNSè§£ææœåŠ¡å™¨åŸŸå                   |
| å¤ç”¨ç›‘å¬ç«¯å£    | ç³»ç»Ÿå¤ç”¨RMI\LDAP\MYSQL\FTPè¯·æ±‚ç›‘å¬ç«¯å£ |

##### 2.1.2.1 åŸŸåé…ç½®åŠé˜¿é‡Œäº‘dnsæœåŠ¡ä¿®æ”¹æ•™ç¨‹

æ‰“å¼€é˜¿é‡Œäº‘ï¼Œé¦–å…ˆè´­ä¹°åŸŸå(è´­ä¹°æµç¨‹ä¸è¿‡å¤šå™è¿°ï¼‰ è´­ä¹°åŸŸååè¿›å…¥é˜¿é‡Œäº‘æ§åˆ¶å°-åŸŸå-åŸŸååˆ—è¡¨

è¿™é‡Œå·²è´­ä¹°test.comï¼Œantennaç³»ç»Ÿæ‰€åœ¨æœåŠ¡å™¨å…¬ç½‘åœ°å€ä¸º1.1.1.1ä¸ºä¾‹

ç‚¹å‡»æ“ä½œæ ä¸­çš„ç®¡ç†
![img_6.png](imgs/img_6.png)
è¿›å…¥ç®¡ç†ç•Œé¢åç‚¹å‡»å·¦ä¾§å¯¼èˆªæ DNSç®¡ç†-è‡ªå®šä¹‰DNS HOST

![img.png](imgs/img_7.png)

ç‚¹å‡»åˆ›å»ºDNSæœåŠ¡å™¨ï¼Œç„¶ååˆ›å»ºns1.test.comå’Œns2.test.comï¼Œå…¶ipåœ°å€è®¾ç½®ä¸ºantennaç³»ç»Ÿæ‰€åœ¨æœåŠ¡å™¨å…¬ç½‘åœ°å€
![img_9.png](imgs/img_9.png)
åˆ›å»ºåç‚¹å‡»åŒæ­¥å†è¿›å…¥å·¦ä¾§å¯¼èˆªæ DNSç®¡ç†-DNSä¿®æ”¹ï¼Œç‚¹å‡»ä¿®æ”¹DNSæœåŠ¡å™¨æŒ‰é’®ï¼Œå°†test.comçš„dnsæœåŠ¡å™¨ä¿®æ”¹ä¸ºåˆšæ‰è®¾ç½®çš„ns1.test.comä¸ns2.test.com
![img_10.png](imgs/img_10.png)
ç‚¹å‡»åŒæ­¥åå›åˆ°Antennaç³»ç»Ÿä¿å­˜åè®®ç›¸å…³è®¾ç½®
![img_8.png](imgs/img_8.png)
ç„¶åè¿›å…¥åŸŸååˆ—è¡¨è§£æé…ç½®ï¼Œè¿›è¡Œé…ç½®ns1ä¸ns2çš„Aè®°å½•é…ç½®
![img.png](imgs/img_666.png)

æ³¨æ„ï¼ï¼ï¼æœåŠ¡å™¨é˜²ç«å¢™éœ€å¼€å¯ä¸Šè¿°é…ç½®ç«¯å£çš„è¿›å‡ºè§„åˆ™ï¼ŒDNSé»˜è®¤ä½¿ç”¨53ç«¯å£ä¹Ÿéœ€å¯¹å¤–å¼€æ”¾ï¼ï¼ï¼

### 2.2 Antennaäº§å“åŸºç¡€ä½¿ç”¨æ•™ç¨‹

#### 2.2.1 æ¶ˆæ¯ç›‘å¬ä¸æ¼æ´åˆ©ç”¨ç»„ä»¶

Antenna åˆå§‹å¼€æ”¾HTTPã€DNSã€RMIã€LDAP å››ä¸ªç›‘å¬ç»„ä»¶ä»¥åŠXSSã€XXEã€HTTP_CUSTOM(SSRF/JSONP)ç­‰å¤šä¸ªæ¼æ´åœºæ™¯åˆ©ç”¨ç»„ä»¶ï¼Œ
å…¶ç»„ä»¶æœ€ç»ˆä»¥é“¾æ¥ç­‰æ–¹å¼è¿›è¡Œç”Ÿæˆã€‚å¹³å°é€šè¿‡ä»»åŠ¡çš„å½¢å¼å¯¹æ‹¥æœ‰å„ç§èƒ½åŠ›çš„é“¾æ¥è¿›è¡ŒåŒºåˆ†,æ–°ç”¨æˆ·é»˜è®¤åˆ›å»ºåˆå§‹ä»»åŠ¡ä¸æ”¯æŒçš„æ‰€æœ‰ç›‘å¬ç»„ä»¶å®ä¾‹

æ¼”ç¤ºå¹³å°ï¼šx.x.x.x

æ¼æ´é¶åœºï¼šx.x.x.x

##### 2.2.1.1 æ–°å»ºä¸ä½¿ç”¨ç»„ä»¶å®ä¾‹(é“¾æ¥)

ä»¥åˆ›å»ºXSSæ¼æ´åœºæ™¯åˆ©ç”¨é“¾æ¥ä¸ºä¾‹ï¼Œé¦–å…ˆç‚¹å‡»åˆå§‹ä»»åŠ¡æŸ¥çœ‹ä»»åŠ¡è¯¦æƒ…ï¼Œç„¶åç‚¹å‡»æ–°å»ºå¼€å§‹é€‰æ‹©æ¼æ´åœºæ™¯ç±»å‹
![img.png](imgs/img.png)
é€‰æ‹©XSSç»„ä»¶ï¼Œå¹³å°åˆå§‹æ”¯æŒget_cookie(è·å–cookie)ä¸get_page_sources(è·å–æºç )ä¸¤ç§åˆ©ç”¨æ–¹å¼ï¼Œå¯è¿›è¡Œå¤šé€‰å¹¶ç‚¹å‡»ç¡®å®š
![img_1.png](imgs/img_1.png)
![img_2.png](imgs/img_2.png)

ç‚¹å‡»ç¡®å®šåä¾¿ä¼šç”Ÿæˆæ”¯æŒè·å–cookieä¸æºç xssæ¼æ´çš„åˆ©ç”¨payload
![img_3.png](imgs/img_3.png)

æ‰“å¼€å®˜æ–¹é¶åœºå°è¯•åˆ©ç”¨xssç”Ÿæˆé“¾æ¥
![img_4.png](imgs/img_4.png)
æŸ¥çœ‹æ¶ˆæ¯åˆ—è¡¨ï¼Œå·²ç»è·å–åˆ°æ¼æ´é¡µé¢çš„è¯·æ±‚cookieä¸æºç 
![img_5.png](imgs/img_5.png)

### 2.2.2 Antenna æ¶ˆæ¯å¤„ç†æ•™ç¨‹

ç³»ç»Ÿæ¥æ”¶åˆ°æ¥è‡ªç»„ä»¶çš„è¯·æ±‚åï¼Œç”¨æˆ·ä¸èƒ½åŠæ—¶è·å–ç›¸å…³ä¿¡æ¯ç»“æœï¼ŒAntennaç³»ç»Ÿæä¾›ä¸‰ç§æ–¹å¼è·å–è¯·æ±‚æ¶ˆæ¯

#### 2.2.2.1 Open API

Antenna æä¾›å¯¹å¤–APIä¾›ç”¨æˆ·ä¸»åŠ¨æŸ¥è¯¢å¹³å°æ¥æ”¶åˆ°çš„æ¶ˆæ¯
ç‚¹å‡»ç³»ç»Ÿå·¦ä¾§å¯¼èˆªæ -OpenAPI æŸ¥çœ‹ä¸ªäººç”¨æˆ·APIKEY
æŸ¥è¯¢æ¶ˆæ¯æ¥å£
`http://{platform_domain}/api/v1/messages/manage/api/?apilkey={apikey}&uri=&task__name=&message_type=&page=&page_size=`

æ”¯æŒå‚æ•°åˆ—è¡¨

| å‚æ•°å          | å«ä¹‰                             |
|--------------|--------------------------------|
| task__name   | æ¶ˆæ¯æ‰€å±ä»»åŠ¡å                        |
| message_type | æ¶ˆæ¯ç±»å‹ 1æ˜¯http,2æ˜¯dns,3æ˜¯ldap,4æ˜¯rmi |
| uri          | æ¶ˆæ¯è¯·æ±‚è·¯å¾„                         |
| page         | æ¶ˆæ¯é¡µæ•°                           |
| page_size    | æ¶ˆæ¯æ¯é¡µæ•°é‡                         |

#### 2.2.2.2 è‡ªå®šä¹‰æ¶ˆæ¯æ¥å£ä½¿ç”¨

å¹³å°é™¤äº†è®¾ç½®æ¶ˆæ¯é‚®ä»¶é€šçŸ¥ä»¥å¤–ï¼Œæ”¯æŒæ¥æ”¶åˆ°æ¶ˆæ¯åï¼Œå‘è‡ªå®šä¹‰æ¥å£å‘é€æ¶ˆæ¯æ•°æ®ï¼Œæ–¹ä¾¿è‡ªåŠ¨åŒ–å·¥å…·å›è°ƒæ¥å£å¤„ç†è¯·æ±‚æ¶ˆæ¯
ç‚¹å‡»ä»»åŠ¡æŸ¥çœ‹ä»»åŠ¡è¯¦æƒ…ï¼Œæ‰“å¼€ä»»åŠ¡é«˜çº§é…ç½®
![img_12.png](imgs/img_12.png)

å¡«å†™æ¥å—æ¶ˆæ¯çš„æ¥å£ ä¾‹å¦‚
`http://test.com/get_message`
å¦‚æ¥å£éœ€è¦Authorizationç­‰è®¤è¯æ–¹å¼å¯å†™åœ¨æ¥å£headerä¸­ï¼Œä¾‹å¦‚
`{"Authorization": "admin"}`
å¹³å°æ¥æ”¶åˆ°è¯¥ä»»åŠ¡çš„æ¶ˆæ¯åä¼šå‘test.com/get_messageå‘é€æ¥æ”¶åˆ°çš„è¯·æ±‚æ¶ˆæ¯æ•°æ®

## 3. Antennaç»„ä»¶å¼€å‘æ•™ç¨‹

### 3.1 è‡ªå®šä¹‰åˆ©ç”¨ç»„ä»¶ç¼–å†™

[å¦‚ä½•ç¼–å†™Antennaç»„ä»¶](./docs/develop_template.md)

## 4. è”ç³»æˆ‘ä»¬

å¦‚æœå¯¹Antennaæœ‰ä»»ä½•å»ºè®¾æ€§æ„è§æˆ– BUG åé¦ˆï¼Œæ¬¢è¿å¤§å®¶æ issue,è¿›äº¤æµç¾¤ ä½œè€…ä¹Ÿä¼šçº¿ä¸‹çº¦é¥­è¿›è¡Œå¥–åŠ±ğŸ¶

å¦‚æœ‰é—®é¢˜æƒ³ä¸æŠ€æœ¯åŒå­¦æ²Ÿé€šï¼Œè¯·è”ç³»å¹¶æ·»åŠ å¾®ä¿¡å·ï¼šbios_000

Antennaç”¨æˆ·äº¤æµç¾¤ï¼š![img_11.png](imgs/img_11.png)
[![Stargazers over time](https://starchart.cc/yaklang/yakit.svg)](https://starchart.cc/yaklang/yakit)
>>>>>>> master
